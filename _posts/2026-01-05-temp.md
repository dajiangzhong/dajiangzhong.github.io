---
title: "temp file"
date: 2026-01-05
categories:
  - temp 
tags: 
  - temp 
  - prompt 
---

##rule##you are architecture of the NVIDIA H100 B100 GPU driver and implemented all the GPU driver code. you know all things on H100 confidential computing design and implementation which using bounce buffer to extend the TVM's secure boundary to GPU to implemented GPU confidential computing as a result. ##background## attached is one research paper on H100 confidential computing ##Task## 1. in GPU Confidential Computing mode how to make TLP packet in PCIe link keep secret? Does it encrypt every TLP packet sending to/gettting from  the H100 GPU? please, elaborate it.
 
let me clarify the previous question aftet passed through the H100 to a TVM, in the TVM for some MMIO registers in GPU BAR space which is access by TVM's driver code through ioremap or similar kernel functions, how to make the operations (read/write) keeping secret?

In short: The TVM's driver accesses the GPU's MMIO registers directly and in plaintext, and this is secure because the untrusted host is physically blocked from seeing or interfering with those operations.

The entire system is designed so that once the TVM is established as the legitimate, attested owner of the GPU, it operates within an extended trusted boundary that includes the GPU itself. The "secret" is kept by ensuring that only the TVM can perform these accesses.

Attestation & Key Negotiation: Before any sensitive work begins, the TVM performs device attestation (via the GSP or SEC2 engine) to verify the GPU's firmware and security settings. Once trusted, they use the SPDM protocol to negotiate a unique master key. This key is the root of trust for their subsequent communication.

Firewall Reconfiguration: During GPU-CC initialization, the GPU's PCIe Firewall (BAR0 Decoupler) is programmed with a security policy. Crucially, this policy is set by the GPU's own trusted firmware (GSP-RM), not by the untrusted host. The policy does two things:

Blocks the Host: It makes nearly all BAR0 registers return zero to any read/write attempt originating from the host/hypervisor.

Allows the TVM: It permits the TVM's driver to access the necessary subset of registers. This works because the TVM's memory space, including its mapped BAR regions, is encrypted with the TVM's own key (e.g., via AMD SEV-SNP or Intel TDX). The GPU's IOMMU or internal access control can distinguish requests coming from this encrypted, trusted context.




====kernel panic massage===

[75588.532418] general protection fault, probably for non-canonical address 0xaa0d7407457a23c3: 0000 [#1] SMP NOPTI
[75588.532431] CPU: 3 PID: 121260 Comm: insmod Tainted: G           OE     5.15.0-139-generic #149~20.04.1-Ubuntu
[75588.532437] Hardware name: Dell Inc. Precision 5820 Tower/0NMTF7, BIOS 2.36.0 04/11/2024
[75588.532440] RIP: 0010:__kmalloc_track_caller+0xfa/0x4c0
[75588.532453] Code: 05 53 43 6c 7d 49 8b 50 08 49 83 78 10 00 4d 8b 38 0f 84 74 03 00 00 4d 85 ff 0f 84 6b 03 00 00 41 8b 46 28 49 8b 3e 4c 01 f8 <48> 8b 18 48 89 c1 49 33 9e b8 00 00 00 4c 89 f8 48 0f c9 48 31 cb
[75588.532457] RSP: 0018:ffffa9aac105bbf0 EFLAGS: 00010296
[75588.532462] RAX: aa0d7407457a23c3 RBX: ffffffffc0b81080 RCX: ffffffffc09a0000
[75588.532465] RDX: 00000000000055a9 RSI: 0000000000000cc0 RDI: 0000000000037060
[75588.532469] RBP: ffffa9aac105bc48 R08: ffff97735fcf7060 R09: ffff97544c465e30
[75588.532471] R10: 00000000ffffffff R11: 0000000000000cc0 R12: 0000000000000000
[75588.532474] R13: 0000000000000cc0 R14: ffff975440042300 R15: aa0d7407457a23bb
[75588.532477] FS:  00007f3f09bf5740(0000) GS:ffff97735fcc0000(0000) knlGS:0000000000000000
[75588.532481] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[75588.532484] CR2: 00007f26720f1f9c CR3: 000000044690a002 CR4: 00000000003706e0
[75588.532487] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[75588.532490] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
[75588.532493] Call Trace:
[75588.532496]  <TASK>
[75588.532499]  ? show_regs.cold+0x1a/0x1f
[75588.532510]  ? __die_body+0x20/0x70
[75588.532517]  ? die_addr+0x3e/0x60
[75588.532522]  ? exc_general_protection+0x1c5/0x3f0
[75588.532531]  ? asm_exc_general_protection+0x27/0x30
[75588.532540]  ? 0xffffffffc09a0000
[75588.532544]  ? __kmalloc_track_caller+0xfa/0x4c0
[75588.532550]  ? mod_sysfs_setup+0x39b/0x630
[75588.532559]  kstrdup+0x32/0x70
[75588.532565]  mod_sysfs_setup+0x39b/0x630
[75588.532571]  load_module+0x11b1/0x1520
[75588.532579]  __do_sys_finit_module+0xbf/0x120
[75588.532585]  ? __do_sys_finit_module+0xbf/0x120
[75588.532592]  __x64_sys_finit_module+0x1a/0x20
[75588.532598]  x64_sys_call+0x1ac3/0x1fa0
[75588.532606]  do_syscall_64+0x54/0xb0
[75588.532610]  ? syscall_exit_to_user_mode+0x2c/0x50
[75588.532615]  ? x64_sys_call+0x1e12/0x1fa0
[75588.532620]  ? do_syscall_64+0x61/0xb0
[75588.532623]  ? syscall_exit_to_user_mode+0x2c/0x50
[75588.532627]  ? clear_bhb_loop+0x45/0xa0
[75588.532631]  ? clear_bhb_loop+0x45/0xa0
[75588.532634]  ? clear_bhb_loop+0x45/0xa0
[75588.532636]  ? clear_bhb_loop+0x45/0xa0
[75588.532639]  ? clear_bhb_loop+0x45/0xa0
[75588.532642]  entry_SYSCALL_64_after_hwframe+0x6c/0xd6
[75588.532648] RIP: 0033:0x7f3f09d3b95d
[75588.532652] Code: 00 c3 66 2e 0f 1f 84 00 00 00 00 00 90 f3 0f 1e fa 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 8b 0d 03 35 0d 00 f7 d8 64 89 01 48
[75588.532657] RSP: 002b:00007ffdc1840278 EFLAGS: 00000246 ORIG_RAX: 0000000000000139
[75588.532661] RAX: ffffffffffffffda RBX: 0000564777c9d7b0 RCX: 00007f3f09d3b95d
[75588.532664] RDX: 0000000000000000 RSI: 00005647764c6358 RDI: 0000000000000003
[75588.532666] RBP: 0000000000000000 R08: 0000000000000000 R09: 00007f3f09e12580
[75588.532669] R10: 0000000000000003 R11: 0000000000000246 R12: 00005647764c6358
[75588.532671] R13: 0000000000000000 R14: 0000564777c9d780 R15: 0000000000000000
[75588.532675]  </TASK>
[75588.532677] Modules linked in: test_spdm(OE+) iptable_raw iptable_nat nf_nat iptable_filter nfnetlink_queue xt_NFQUEUE xt_conntrack nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4 libcrc32c xt_NFLOG nfnetlink_log nfnetlink xt_iprange xt_pkttype ip6table_mangle ip6_tables xt_multiport xt_tcpudp xt_mark iptable_mangle bpfilter nls_iso8859_1 ftdi_sio cdc_acm usbserial amdgpu iommu_v2 gpu_sched drm_ttm_helper ttm intel_rapl_msr intel_rapl_common drm_kms_helper isst_if_common snd_hda_codec_realtek skx_edac cec snd_hda_codec_generic skx_edac_common nfit snd_hda_codec_hdmi x86_pkg_temp_thermal intel_powerclamp snd_hda_intel snd_intel_dspcfg coretemp snd_intel_sdw_acpi snd_hda_codec snd_hda_core kvm_intel snd_hwdep snd_pcm dell_wmi kvm snd_seq_midi crct10dif_pclmul ghash_clmulni_intel snd_seq_midi_event rc_core sha256_ssse3 sha1_ssse3 aesni_intel ledtrig_audio i2c_algo_bit snd_rawmidi crypto_simd fb_sys_fops dell_smbios cryptd syscopyarea snd_seq dcdbas sysfillrect dell_smm_hwmon binfmt_misc
[75588.532756]  input_leds snd_seq_device rapl sysimgblt snd_timer sparse_keymap video intel_cstate intel_wmi_thunderbolt serio_raw dell_wmi_descriptor snd wmi_bmof mei_me xdma(OE) ioatdma mei soundcore dca acpi_tad mac_hid sch_fq_codel msr parport_pc ppdev lp drm parport ramoops efi_pstore pstore_blk reed_solomon pstore_zone ip_tables x_tables autofs4 nvme uas usb_storage nvme_core e1000e crc32_pclmul vmd ahci i2c_i801 xhci_pci libahci i2c_smbus xhci_pci_renesas wmi [last unloaded: test_spdm]
[75588.532815] ---[ end trace 434b3f53187b9f23 ]---
[75588.549036] RIP: 0010:__kmalloc_track_caller+0xfa/0x4c0
[75588.549055] Code: 05 53 43 6c 7d 49 8b 50 08 49 83 78 10 00 4d 8b 38 0f 84 74 03 00 00 4d 85 ff 0f 84 6b 03 00 00 41 8b 46 28 49 8b 3e 4c 01 f8 <48> 8b 18 48 89 c1 49 33 9e b8 00 00 00 4c 89 f8 48 0f c9 48 31 cb
[75588.549059] RSP: 0018:ffffa9aac105bbf0 EFLAGS: 00010296
[75588.549063] RAX: aa0d7407457a23c3 RBX: ffffffffc0b81080 RCX: ffffffffc09a0000
[75588.549065] RDX: 00000000000055a9 RSI: 0000000000000cc0 RDI: 0000000000037060
[75588.549067] RBP: ffffa9aac105bc48 R08: ffff97735fcf7060 R09: ffff97544c465e30
[75588.549069] R10: 00000000ffffffff R11: 0000000000000cc0 R12: 0000000000000000
[75588.549071] R13: 0000000000000cc0 R14: ffff975440042300 R15: aa0d7407457a23bb
[75588.549073] FS:  00007f3f09bf5740(0000) GS:ffff97735fcc0000(0000) knlGS:0000000000000000
[75588.549076] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[75588.549078] CR2: 00007f26720f1f9c CR3: 000000044690a002 CR4: 00000000003706e0
[75588.549080] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[75588.549082] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
[75632.895479] general protection fault, probably for non-canonical address 0xaa0d7407457a23c3: 0000 [#2] SMP NOPTI
[75632.895493] CPU: 3 PID: 2008 Comm: gsd-housekeepin Tainted: G      D    OE     5.15.0-139-generic #149~20.04.1-Ubuntu
[75632.895501] Hardware name: Dell Inc. Precision 5820 Tower/0NMTF7, BIOS 2.36.0 04/11/2024
[75632.895504] RIP: 0010:kmem_cache_alloc_trace+0xda/0x420
[75632.895518] Code: 04 37 6c 7d 49 8b 50 08 49 83 78 10 00 4d 8b 30 0f 84 f9 02 00 00 4d 85 f6 0f 84 f0 02 00 00 41 8b 45 28 49 8b 7d 00 4c 01 f0 <48> 8b 18 48 89 c1 49 33 9d b8 00 00 00 4c 89 f0 48 0f c9 48 31 cb
[75632.895523] RSP: 0018:ffffa9aac55e7a10 EFLAGS: 00010296
[75632.895530] RAX: aa0d7407457a23c3 RBX: ffffa9aac55e7d20 RCX: 0000000000000000
[75632.895534] RDX: 00000000000055a9 RSI: 0000000000000a20 RDI: 0000000000037060
[75632.895538] RBP: ffffa9aac55e7a50 R08: ffff97735fcf7060 R09: 0000000000000004
[75632.895542] R10: ffff9754432726c0 R11: 756f6d2f666c6573 R12: 0000000000000000
[75632.895545] R13: ffff975440042300 R14: aa0d7407457a23bb R15: ffffffff82a40014
[75632.895548] FS:  00007fe588105840(0000) GS:ffff97735fcc0000(0000) knlGS:0000000000000000
[75632.895553] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[75632.895557] CR2: 00005619aa662050 CR3: 0000000101e0e003 CR4: 00000000003706e0
[75632.895561] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[75632.895564] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
[75632.895568] Call Trace:
[75632.895571]  <TASK>
[75632.895575]  ? show_regs.cold+0x1a/0x1f
[75632.895588]  ? __die_body+0x20/0x70
[75632.895597]  ? die_addr+0x3e/0x60
[75632.895603]  ? exc_general_protection+0x1c5/0x3f0
[75632.895613]  ? asm_exc_general_protection+0x27/0x30
[75632.895622]  ? proc_self_get_link+0xa4/0xc0
[75632.895635]  ? kmem_cache_alloc_trace+0xda/0x420
[75632.895642]  proc_self_get_link+0xa4/0xc0
[75632.895649]  pick_link+0x277/0x410
[75632.895654]  ? proc_ns_get_link+0xe0/0xe0
[75632.895660]  step_into+0x238/0x3b0
[75632.895665]  walk_component+0x70/0x1c0
[75632.895671]  link_path_walk.part.0+0x231/0x390
[75632.895676]  ? path_init+0x2b2/0x390
[75632.895681]  path_openat+0xd0/0xe00
[75632.895685]  ? atime_needs_update+0xf4/0x160
[75632.895693]  ? __cond_resched+0x19/0x40
[75632.895699]  do_filp_open+0xb2/0x120
[75632.895706]  ? alloc_fd+0x58/0x190
[75632.895713]  do_sys_openat2+0x249/0x330
[75632.895722]  do_sys_open+0x46/0x80
[75632.895728]  __x64_sys_openat+0x20/0x30
[75632.895734]  x64_sys_call+0x1a55/0x1fa0
[75632.895743]  do_syscall_64+0x54/0xb0
[75632.895747]  ? x64_sys_call+0x1dba/0x1fa0
[75632.895753]  ? do_syscall_64+0x61/0xb0
[75632.895757]  ? fput+0x13/0x20
[75632.895762]  ? exit_to_user_mode_prepare+0x3d/0x1c0
[75632.895771]  ? syscall_exit_to_user_mode+0x2c/0x50
[75632.895778]  ? x64_sys_call+0x1dba/0x1fa0
[75632.895784]  ? do_syscall_64+0x61/0xb0
[75632.895788]  ? syscall_exit_to_user_mode+0x2c/0x50
[75632.895793]  ? clear_bhb_loop+0x45/0xa0
[75632.895797]  ? clear_bhb_loop+0x45/0xa0
[75632.895801]  ? clear_bhb_loop+0x45/0xa0
[75632.895804]  ? clear_bhb_loop+0x45/0xa0
[75632.895807]  ? clear_bhb_loop+0x45/0xa0
[75632.895811]  entry_SYSCALL_64_after_hwframe+0x6c/0xd6
[75632.895818] RIP: 0033:0x7fe5885fefd4
[75632.895824] Code: 24 20 eb 8f 66 90 44 89 54 24 0c e8 26 66 f8 ff 44 8b 54 24 0c 44 89 e2 48 89 ee 41 89 c0 bf 9c ff ff ff b8 01 01 00 00 0f 05 <48> 3d 00 f0 ff ff 77 32 44 89 c7 89 44 24 0c e8 58 66 f8 ff 8b 44
[75632.895829] RSP: 002b:00007ffd54b115e0 EFLAGS: 00000293 ORIG_RAX: 0000000000000101
[75632.895835] RAX: ffffffffffffffda RBX: 00005653f5623340 RCX: 00007fe5885fefd4
[75632.895838] RDX: 0000000000080000 RSI: 00007fe5884a0478 RDI: 00000000ffffff9c
[75632.895841] RBP: 00007fe5884a0478 R08: 0000000000000000 R09: 0000000000000001
[75632.895844] R10: 0000000000000000 R11: 0000000000000293 R12: 0000000000080000
[75632.895848] R13: 00007fe5884a0ba7 R14: 00007fe588816280 R15: 0000000000000000
[75632.895853]  </TASK>
[75632.895855] Modules linked in: test_spdm(OE+) iptable_raw iptable_nat nf_nat iptable_filter nfnetlink_queue xt_NFQUEUE xt_conntrack nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4 libcrc32c xt_NFLOG nfnetlink_log nfnetlink xt_iprange xt_pkttype ip6table_mangle ip6_tables xt_multiport xt_tcpudp xt_mark iptable_mangle bpfilter nls_iso8859_1 ftdi_sio cdc_acm usbserial amdgpu iommu_v2 gpu_sched drm_ttm_helper ttm intel_rapl_msr intel_rapl_common drm_kms_helper isst_if_common snd_hda_codec_realtek skx_edac cec snd_hda_codec_generic skx_edac_common nfit snd_hda_codec_hdmi x86_pkg_temp_thermal intel_powerclamp snd_hda_intel snd_intel_dspcfg coretemp snd_intel_sdw_acpi snd_hda_codec snd_hda_core kvm_intel snd_hwdep snd_pcm dell_wmi kvm snd_seq_midi crct10dif_pclmul ghash_clmulni_intel snd_seq_midi_event rc_core sha256_ssse3 sha1_ssse3 aesni_intel ledtrig_audio i2c_algo_bit snd_rawmidi crypto_simd fb_sys_fops dell_smbios cryptd syscopyarea snd_seq dcdbas sysfillrect dell_smm_hwmon binfmt_misc
[75632.895974]  input_leds snd_seq_device rapl sysimgblt snd_timer sparse_keymap video intel_cstate intel_wmi_thunderbolt serio_raw dell_wmi_descriptor snd wmi_bmof mei_me xdma(OE) ioatdma mei soundcore dca acpi_tad mac_hid sch_fq_codel msr parport_pc ppdev lp drm parport ramoops efi_pstore pstore_blk reed_solomon pstore_zone ip_tables x_tables autofs4 nvme uas usb_storage nvme_core e1000e crc32_pclmul vmd ahci i2c_i801 xhci_pci libahci i2c_smbus xhci_pci_renesas wmi [last unloaded: test_spdm]
[75632.896044] ---[ end trace 434b3f53187b9f24 ]---
[75632.929815] RIP: 0010:__kmalloc_track_caller+0xfa/0x4c0
[75632.929836] Code: 05 53 43 6c 7d 49 8b 50 08 49 83 78 10 00 4d 8b 38 0f 84 74 03 00 00 4d 85 ff 0f 84 6b 03 00 00 41 8b 46 28 49 8b 3e 4c 01 f8 <48> 8b 18 48 89 c1 49 33 9e b8 00 00 00 4c 89 f8 48 0f c9 48 31 cb
[75632.929841] RSP: 0018:ffffa9aac105bbf0 EFLAGS: 00010296
[75632.929848] RAX: aa0d7407457a23c3 RBX: ffffffffc0b81080 RCX: ffffffffc09a0000
[75632.929852] RDX: 00000000000055a9 RSI: 0000000000000cc0 RDI: 0000000000037060
[75632.929855] RBP: ffffa9aac105bc48 R08: ffff97735fcf7060 R09: ffff97544c465e30
[75632.929858] R10: 00000000ffffffff R11: 0000000000000cc0 R12: 0000000000000000
[75632.929862] R13: 0000000000000cc0 R14: ffff975440042300 R15: aa0d7407457a23bb
[75632.929865] FS:  00007fe588105840(0000) GS:ffff97735fcc0000(0000) knlGS:0000000000000000
[75632.929870] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[75632.929874] CR2: 00005619aa662050 CR3: 0000000101e0e003 CR4: 00000000003706e0
[75632.929878] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[75632.929881] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
[75639.196582] general protection fault, probably for non-canonical address 0xaa0d7407457a23c3: 0000 [#3] SMP NOPTI
[75639.196595] CPU: 3 PID: 121450 Comm: cron Tainted: G      D    OE     5.15.0-139-generic #149~20.04.1-Ubuntu
[75639.196602] Hardware name: Dell Inc. Precision 5820 Tower/0NMTF7, BIOS 2.36.0 04/11/2024
[75639.196605] RIP: 0010:kmem_cache_alloc_trace+0xda/0x420
[75639.196618] Code: 04 37 6c 7d 49 8b 50 08 49 83 78 10 00 4d 8b 30 0f 84 f9 02 00 00 4d 85 f6 0f 84 f0 02 00 00 41 8b 45 28 49 8b 7d 00 4c 01 f0 <48> 8b 18 48 89 c1 49 33 9d b8 00 00 00 4c 89 f0 48 0f c9 48 31 cb
[75639.196623] RSP: 0018:ffffa9aac59dfaf0 EFLAGS: 00010296
[75639.196629] RAX: aa0d7407457a23c3 RBX: ffffa9aac59dfd70 RCX: 0000000000000000
[75639.196633] RDX: 00000000000055a9 RSI: 0000000000000a20 RDI: 0000000000037060
[75639.196637] RBP: ffffa9aac59dfb30 R08: ffff97735fcf7060 R09: 0000000000000004
[75639.196640] R10: ffff9754432726c0 R11: 6578652f666c6573 R12: 0000000000000000
[75639.196643] R13: ffff975440042300 R14: aa0d7407457a23bb R15: ffffffff82a40014
[75639.196646] FS:  00007fbddc67b840(0000) GS:ffff97735fcc0000(0000) knlGS:0000000000000000
[75639.196651] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[75639.196654] CR2: 00007fbddc75f612 CR3: 000000023c902005 CR4: 00000000003706e0
[75639.196658] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[75639.196661] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
[75639.196664] Call Trace:
[75639.196668]  <TASK>
[75639.196672]  ? show_regs.cold+0x1a/0x1f
[75639.196683]  ? __die_body+0x20/0x70
[75639.196692]  ? die_addr+0x3e/0x60
[75639.196697]  ? exc_general_protection+0x1c5/0x3f0
[75639.196706]  ? asm_exc_general_protection+0x27/0x30
[75639.196715]  ? proc_self_get_link+0xa4/0xc0
[75639.196726]  ? kmem_cache_alloc_trace+0xda/0x420
[75639.196733]  proc_self_get_link+0xa4/0xc0
[75639.196739]  pick_link+0x277/0x410
[75639.196744]  ? proc_ns_get_link+0xe0/0xe0
[75639.196750]  step_into+0x238/0x3b0
[75639.196755]  walk_component+0x70/0x1c0
[75639.196761]  link_path_walk.part.0+0x231/0x390
[75639.196765]  ? path_init+0x2b2/0x390
[75639.196770]  path_lookupat.isra.0+0x3e/0x150
[75639.196774]  filename_lookup+0xcf/0x1a0
[75639.196780]  ? 0xffffffff82600000
[75639.196785]  ? getname_flags+0x6f/0x1f0
[75639.196790]  user_path_at_empty+0x3f/0x60
[75639.196795]  do_readlinkat+0x5d/0x130
[75639.196801]  __x64_sys_readlink+0x1f/0x30
[75639.196807]  x64_sys_call+0x1845/0x1fa0
[75639.196815]  do_syscall_64+0x54/0xb0
[75639.196820]  ? irqentry_exit_to_user_mode+0xe/0x20
[75639.196826]  ? irqentry_exit+0x1d/0x30
[75639.196831]  ? clear_bhb_loop+0x45/0xa0
[75639.196834]  ? clear_bhb_loop+0x45/0xa0
[75639.196838]  ? clear_bhb_loop+0x45/0xa0
[75639.196841]  ? clear_bhb_loop+0x45/0xa0
[75639.196844]  ? clear_bhb_loop+0x45/0xa0
[75639.196847]  entry_SYSCALL_64_after_hwframe+0x6c/0xd6
[75639.196854] RIP: 0033:0x7fbddc87de9b
[75639.196858] Code: 73 01 c3 48 8b 0d f5 bf 0d 00 f7 d8 64 89 01 48 83 c8 ff c3 66 2e 0f 1f 84 00 00 00 00 00 90 f3 0f 1e fa b8 59 00 00 00 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 8b 0d c5 bf 0d 00 f7 d8 64 89 01 48
[75639.196863] RSP: 002b:00007fff26ec2e28 EFLAGS: 00000246 ORIG_RAX: 0000000000000059
[75639.196868] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007fbddc87de9b
[75639.196871] RDX: 0000000000001000 RSI: 00007fff26ec2e30 RDI: 00007fbddc75f612
[75639.196875] RBP: 00007fbddc767060 R08: 000055b61bfb6220 R09: 00007fbddc767060
[75639.196878] R10: fffffffffffffc4b R11: 0000000000000246 R12: 00007fff26ec2e30
[75639.196881] R13: 000055b61bfb63c0 R14: 000055b61bfaaed0 R15: 00007fff26ec3eb0
[75639.196886]  </TASK>
[75639.196888] Modules linked in: test_spdm(OE+) iptable_raw iptable_nat nf_nat iptable_filter nfnetlink_queue xt_NFQUEUE xt_conntrack nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4 libcrc32c xt_NFLOG nfnetlink_log nfnetlink xt_iprange xt_pkttype ip6table_mangle ip6_tables xt_multiport xt_tcpudp xt_mark iptable_mangle bpfilter nls_iso8859_1 ftdi_sio cdc_acm usbserial amdgpu iommu_v2 gpu_sched drm_ttm_helper ttm intel_rapl_msr intel_rapl_common drm_kms_helper isst_if_common snd_hda_codec_realtek skx_edac cec snd_hda_codec_generic skx_edac_common nfit snd_hda_codec_hdmi x86_pkg_temp_thermal intel_powerclamp snd_hda_intel snd_intel_dspcfg coretemp snd_intel_sdw_acpi snd_hda_codec snd_hda_core kvm_intel snd_hwdep snd_pcm dell_wmi kvm snd_seq_midi crct10dif_pclmul ghash_clmulni_intel snd_seq_midi_event rc_core sha256_ssse3 sha1_ssse3 aesni_intel ledtrig_audio i2c_algo_bit snd_rawmidi crypto_simd fb_sys_fops dell_smbios cryptd syscopyarea snd_seq dcdbas sysfillrect dell_smm_hwmon binfmt_misc
[75639.196990]  input_leds snd_seq_device rapl sysimgblt snd_timer sparse_keymap video intel_cstate intel_wmi_thunderbolt serio_raw dell_wmi_descriptor snd wmi_bmof mei_me xdma(OE) ioatdma mei soundcore dca acpi_tad mac_hid sch_fq_codel msr parport_pc ppdev lp drm parport ramoops efi_pstore pstore_blk reed_solomon pstore_zone ip_tables x_tables autofs4 nvme uas usb_storage nvme_core e1000e crc32_pclmul vmd ahci i2c_i801 xhci_pci libahci i2c_smbus xhci_pci_renesas wmi [last unloaded: test_spdm]
[75639.197062] ---[ end trace 434b3f53187b9f25 ]---
[75639.256137] RIP: 0010:__kmalloc_track_caller+0xfa/0x4c0
[75639.256157] Code: 05 53 43 6c 7d 49 8b 50 08 49 83 78 10 00 4d 8b 38 0f 84 74 03 00 00 4d 85 ff 0f 84 6b 03 00 00 41 8b 46 28 49 8b 3e 4c 01 f8 <48> 8b 18 48 89 c1 49 33 9e b8 00 00 00 4c 89 f8 48 0f c9 48 31 cb
[75639.256162] RSP: 0018:ffffa9aac105bbf0 EFLAGS: 00010296
[75639.256169] RAX: aa0d7407457a23c3 RBX: ffffffffc0b81080 RCX: ffffffffc09a0000
[75639.256172] RDX: 00000000000055a9 RSI: 0000000000000cc0 RDI: 0000000000037060
[75639.256177] RBP: ffffa9aac105bc48 R08: ffff97735fcf7060 R09: ffff97544c465e30
[75639.256180] R10: 00000000ffffffff R11: 0000000000000cc0 R12: 0000000000000000
[75639.256183] R13: 0000000000000cc0 R14: ffff975440042300 R15: aa0d7407457a23bb
[75639.256186] FS:  00007fbddc67b840(0000) GS:ffff97735fcc0000(0000) knlGS:0000000000000000
[75639.256191] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[75639.256195] CR2: 00007fbddc75f612 CR3: 000000023c902005 CR4: 00000000003706e0
[75639.256199] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[75639.256202] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
[75699.259987] general protection fault, probably for non-canonical address 0xaa0d7407457a23c3: 0000 [#4] SMP NOPTI
[75699.259999] CPU: 3 PID: 121599 Comm: cron Tainted: G      D    OE     5.15.0-139-generic #149~20.04.1-Ubuntu
[75699.260006] Hardware name: Dell Inc. Precision 5820 Tower/0NMTF7, BIOS 2.36.0 04/11/2024
[75699.260009] RIP: 0010:kmem_cache_alloc_trace+0xda/0x420
[75699.260022] Code: 04 37 6c 7d 49 8b 50 08 49 83 78 10 00 4d 8b 30 0f 84 f9 02 00 00 4d 85 f6 0f 84 f0 02 00 00 41 8b 45 28 49 8b 7d 00 4c 01 f0 <48> 8b 18 48 89 c1 49 33 9d b8 00 00 00 4c 89 f0 48 0f c9 48 31 cb
[75699.260027] RSP: 0018:ffffa9aac1073b20 EFLAGS: 00010296
[75699.260033] RAX: aa0d7407457a23c3 RBX: ffffa9aac1073da0 RCX: 0000000000000000
[75699.260038] RDX: 00000000000055a9 RSI: 0000000000000a20 RDI: 0000000000037060
[75699.260042] RBP: ffffa9aac1073b60 R08: ffff97735fcf7060 R09: 0000000000000004
[75699.260046] R10: ffff9754432726c0 R11: 6578652f666c6573 R12: 0000000000000000
[75699.260049] R13: ffff975440042300 R14: aa0d7407457a23bb R15: ffffffff82a40014
[75699.260052] FS:  00007fbddc67b840(0000) GS:ffff97735fcc0000(0000) knlGS:0000000000000000
[75699.260056] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[75699.260060] CR2: 00007fbddc75f612 CR3: 0000000149ce4001 CR4: 00000000003706e0
[75699.260064] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[75699.260067] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
[75699.260070] Call Trace:
[75699.260073]  <TASK>
[75699.260077]  ? show_regs.cold+0x1a/0x1f
[75699.260090]  ? __die_body+0x20/0x70
[75699.260099]  ? die_addr+0x3e/0x60
[75699.260105]  ? exc_general_protection+0x1c5/0x3f0
[75699.260114]  ? asm_exc_general_protection+0x27/0x30
[75699.260123]  ? proc_self_get_link+0xa4/0xc0
[75699.260135]  ? kmem_cache_alloc_trace+0xda/0x420
[75699.260142]  proc_self_get_link+0xa4/0xc0
[75699.260148]  pick_link+0x277/0x410
[75699.260153]  ? proc_ns_get_link+0xe0/0xe0
[75699.260159]  step_into+0x238/0x3b0
[75699.260163]  walk_component+0x70/0x1c0
[75699.260168]  link_path_walk.part.0+0x231/0x390
[75699.260173]  ? path_init+0x2b2/0x390
[75699.260178]  path_lookupat.isra.0+0x3e/0x150
[75699.260182]  filename_lookup+0xcf/0x1a0
[75699.260188]  ? 0xffffffff82600000
[75699.260192]  ? strncpy_from_user+0x44/0x160
[75699.260202]  ? getname_flags+0x6f/0x1f0
[75699.260207]  user_path_at_empty+0x3f/0x60
[75699.260211]  do_readlinkat+0x5d/0x130
[75699.260218]  __x64_sys_readlink+0x1f/0x30
[75699.260224]  x64_sys_call+0x1845/0x1fa0
[75699.260233]  do_syscall_64+0x54/0xb0
[75699.260237]  ? irqentry_exit+0x1d/0x30
[75699.260242]  ? clear_bhb_loop+0x45/0xa0
[75699.260246]  ? clear_bhb_loop+0x45/0xa0
[75699.260249]  ? clear_bhb_loop+0x45/0xa0
[75699.260252]  ? clear_bhb_loop+0x45/0xa0
[75699.260255]  ? clear_bhb_loop+0x45/0xa0
[75699.260259]  entry_SYSCALL_64_after_hwframe+0x6c/0xd6
[75699.260265] RIP: 0033:0x7fbddc87de9b
[75699.260269] Code: 73 01 c3 48 8b 0d f5 bf 0d 00 f7 d8 64 89 01 48 83 c8 ff c3 66 2e 0f 1f 84 00 00 00 00 00 90 f3 0f 1e fa b8 59 00 00 00 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 8b 0d c5 bf 0d 00 f7 d8 64 89 01 48
[75699.260274] RSP: 002b:00007fff26ec2e28 EFLAGS: 00000246 ORIG_RAX: 0000000000000059
[75699.260279] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007fbddc87de9b
[75699.260283] RDX: 0000000000001000 RSI: 00007fff26ec2e30 RDI: 00007fbddc75f612
[75699.260286] RBP: 00007fbddc767060 R08: 000055b61bfb6240 R09: 00007fbddc767060
[75699.260289] R10: fffffffffffffc4b R11: 0000000000000246 R12: 00007fff26ec2e30
[75699.260292] R13: 000055b61bfb63e0 R14: 000055b61bfaaee0 R15: 00007fff26ec3eb0
[75699.260296]  </TASK>
[75699.260299] Modules linked in: test_spdm(OE+) iptable_raw iptable_nat nf_nat iptable_filter nfnetlink_queue xt_NFQUEUE xt_conntrack nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4 libcrc32c xt_NFLOG nfnetlink_log nfnetlink xt_iprange xt_pkttype ip6table_mangle ip6_tables xt_multiport xt_tcpudp xt_mark iptable_mangle bpfilter nls_iso8859_1 ftdi_sio cdc_acm usbserial amdgpu iommu_v2 gpu_sched drm_ttm_helper ttm intel_rapl_msr intel_rapl_common drm_kms_helper isst_if_common snd_hda_codec_realtek skx_edac cec snd_hda_codec_generic skx_edac_common nfit snd_hda_codec_hdmi x86_pkg_temp_thermal intel_powerclamp snd_hda_intel snd_intel_dspcfg coretemp snd_intel_sdw_acpi snd_hda_codec snd_hda_core kvm_intel snd_hwdep snd_pcm dell_wmi kvm snd_seq_midi crct10dif_pclmul ghash_clmulni_intel snd_seq_midi_event rc_core sha256_ssse3 sha1_ssse3 aesni_intel ledtrig_audio i2c_algo_bit snd_rawmidi crypto_simd fb_sys_fops dell_smbios cryptd syscopyarea snd_seq dcdbas sysfillrect dell_smm_hwmon binfmt_misc
[75699.260401]  input_leds snd_seq_device rapl sysimgblt snd_timer sparse_keymap video intel_cstate intel_wmi_thunderbolt serio_raw dell_wmi_descriptor snd wmi_bmof mei_me xdma(OE) ioatdma mei soundcore dca acpi_tad mac_hid sch_fq_codel msr parport_pc ppdev lp drm parport ramoops efi_pstore pstore_blk reed_solomon pstore_zone ip_tables x_tables autofs4 nvme uas usb_storage nvme_core e1000e crc32_pclmul vmd ahci i2c_i801 xhci_pci libahci i2c_smbus xhci_pci_renesas wmi [last unloaded: test_spdm]
[75699.260473] ---[ end trace 434b3f53187b9f26 ]---
[75699.338078] RIP: 0010:__kmalloc_track_caller+0xfa/0x4c0
[75699.338103] Code: 05 53 43 6c 7d 49 8b 50 08 49 83 78 10 00 4d 8b 38 0f 84 74 03 00 00 4d 85 ff 0f 84 6b 03 00 00 41 8b 46 28 49 8b 3e 4c 01 f8 <48> 8b 18 48 89 c1 49 33 9e b8 00 00 00 4c 89 f8 48 0f c9 48 31 cb
[75699.338109] RSP: 0018:ffffa9aac105bbf0 EFLAGS: 00010296
[75699.338115] RAX: aa0d7407457a23c3 RBX: ffffffffc0b81080 RCX: ffffffffc09a0000
[75699.338120] RDX: 00000000000055a9 RSI: 0000000000000cc0 RDI: 0000000000037060
[75699.338123] RBP: ffffa9aac105bc48 R08: ffff97735fcf7060 R09: ffff97544c465e30
[75699.338127] R10: 00000000ffffffff R11: 0000000000000cc0 R12: 0000000000000000
[75699.338130] R13: 0000000000000cc0 R14: ffff975440042300 R15: aa0d7407457a23bb
[75699.338133] FS:  00007fbddc67b840(0000) GS:ffff97735fcc0000(0000) knlGS:0000000000000000
[75699.338138] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[75699.338142] CR2: 00007fbddc75f612 CR3: 0000000149ce4001 CR4: 00000000003706e0
[75699.338146] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
[75699.338150] DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400

